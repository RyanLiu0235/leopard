!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.Leopard=r()}(this,function(){"use strict";var e=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};function r(e){return e.replace(/"/g,'\\"')}function t(){}var n=t.prototype;function i(e){return e.split("|").reduce((e,r)=>r.trim()+"("+e.trim()+")")}n.parse=function(e,t){t=t||{};var n="var lines = [];\nvar rst;\nwith("+JSON.stringify(t)+") {\n";function o(e){n+="lines.push("+e+");\n"}function u(e){var r=e.charAt(0);if(["=","-"].indexOf(r)>-1){var t=e.substr(1).trim();if(""===t)return;o("="===r?"escape("+i(t)+")":i(t))}else n+=e+"\n"}var s=/\S/;function a(e){return s.test(e)}for(var l,f=e.split("\n"),c=/<%(.+?)%>/g,p=/\s*$/,v=0,d=f.length;v<d;v++){var h=null,g=null,y=v===d-1;if(a(l=f[v].replace(p,"")))if(null!==(h=c.exec(l))){for(;h;){var b=l.substring(null!==g?g.index+g[0].length:0,h.index);a(b)&&o('"'+r(b)+'"');var m=h[1].trim();m&&u(m),g=h,h=c.exec(l)}var x=l.substr(g.index+g[0].length);a(x)&&o('"'+r(x)+(y?'"':'\\n"'))}else o('"'+r(l)+(y?'"':'\\n"'));else n+="\n"}return n+='rst = lines.join("");\n}\nreturn rst;'},n.compile=function(r,t){var i=this.parse(r,t);return new Function("escape",...Object.keys(n),i).call(n,e,...Object.values(n))};var o=t;var u=function(e,r){if("function"!=typeof r)throw new TypeError('Leopard: filter requires a function as handler, but got "'+typeof r+'" in filter "'+e+'"');if(e in this.prototype)throw new Error('Leopard: filter "'+e+'" has been declared');return this.prototype[e]=r,this},s={capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},reverse:function(e){return e.split("").reverse().join("")}};o.filter=u;for(var a,l=Object.keys(s),f=0,c=l.length;f<c;f++)a=l[f],o.filter(a,s[a]);return o});
