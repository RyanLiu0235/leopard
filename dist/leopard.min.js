!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.Leopard=r()}(this,function(){"use strict";var e=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},r=function(e){return e.replace(/"/g,'\\"')};function t(){}var n=t.prototype,i=function(e){return e.split("|").reduce((e,r)=>r.trim()+"("+e.trim()+")")};n.parse=function(e,t){t=t||{};var n=/<%(.+?)%>/g,o=null,u=null,a="var lines = [];\nvar rst;\nwith("+JSON.stringify(t)+") {\n";function s(e){a+="lines.push("+e+");\n"}for(var c=function(e){if(e.length>0)switch(e.charAt(0)){case"=":s("escape("+i(e.substr(1).trim())+")");break;case"-":s(i(e.substr(1).trim()));break;default:a+=e+"\n"}};o=n.exec(e);){var f=e.substring(null!==u?u.index+u[0].length:0,o.index);f&&s('"'+r(f)+'"');var l=o[1].trim();l&&c(l),u=o}var p=e.substr(u.index+u[0].length);return p&&s('"'+r(p)+'"'),a+='rst = lines.join("");\n}\nreturn rst;'},n.compile=function(r,t){var i=this.parse(r,t);return new Function("escape",...Object.keys(n),i).call(n,e,...Object.values(n))};var o=t;var u=function(e,r){if("function"!=typeof r)throw new TypeError('Leopard: filter requires a function as handler, but got "'+typeof r+'" in filter "'+e+'"');if(e in this.prototype)throw new Error('Leopard: filter "'+e+'" has been declared');return this.prototype[e]=r,this},a={capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},reverse:function(e){return e.split("").reverse().join("")}};o.filter=u;for(var s,c=Object.keys(a),f=0,l=c.length;f<l;f++)s=c[f],o.filter(s,a[s]);return o});
